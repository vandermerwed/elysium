---
import Layout from "@layouts/Layout.astro";
import Main from "@layouts/Main.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import Pagination from "@components/Pagination.astro";
import Card from "@components/Card";
import { SITE } from "@config";
import type { Page } from "astro";
import type { CollectionEntry } from "astro:content";

type CollectionName = "notes" | "writing" | "journal" | "projects";

export interface Props {
  page: Page<CollectionEntry<CollectionName>>;
  activeNav?: "notes" | "writing" | "journal" | "projects";
  pageTitle?: string;
  pageDesc?: string;
  basePath?: string;
  showNexusScore?: boolean;
}

const {
  page,
  activeNav = "notes",
  pageTitle = "Notes",
  pageDesc = "All the notes I've posted.",
  basePath = "notes",
  showNexusScore = basePath === "notes",
} = Astro.props;
---

<Layout title={`${pageTitle} | ${SITE.title}`}>
  <Header activeNav={activeNav} />
  <Main pageTitle={pageTitle} pageDesc={pageDesc}>
    <ul>
      {
        page.data.map(({ data, id }) => {
          const resolvedType = data.type ?? (basePath === "writing" ? "essay" : basePath === "journal" ? "journal" : basePath === "notes" ? "note" : data.type);
          return (
            <Card
              href={`/${basePath}/${id}/`}
              frontmatter={{ ...data, type: resolvedType }}
              showNexusScore={showNexusScore}
              contentType={resolvedType}
            />
          );
        })
      }
    </ul>
  </Main>

  <Pagination {page} />

  <Footer noMarginTop={page.lastPage > 1} />
</Layout>
