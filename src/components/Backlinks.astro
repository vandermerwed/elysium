---
import SectionHeader from "@components/SectionHeader.astro";

export interface Props {
  backlinks: Array<{
    title: string;
    url: string;
    type?: string;
    description?: string;
  }>;
  title?: string;
}

const { backlinks, title = "Backlinks" } = Astro.props;
const formatTypeLabel = (value?: string) => {
  if (!value) return undefined;
  return value.charAt(0).toUpperCase() + value.slice(1);
};
---

{backlinks && backlinks.length > 0 && (
  <section class="backlinks">
    <SectionHeader title={title} count={backlinks.length} />
    <ul>
      {backlinks.map(link => (
        <li>
          <a href={link.url} class="backlink-card">
            <span class="backlink-header">
              <span class="backlink-arrow" aria-hidden="true">&larr;</span>
              <span class="backlink-title">{link.title}</span>
              {link.type && (
                <span class="backlink-type">{formatTypeLabel(link.type)}</span>
              )}
            </span>
            {link.description && <p class="backlink-desc">{link.description}</p>}
          </a>
        </li>
      ))}
    </ul>
  </section>
)}

<style>
  .backlinks {
    @apply my-6;
  }
  .backlinks ul {
    @apply mt-4 grid gap-3;
    list-style: none;
    padding: 0;
  }
  .backlinks li {
    @apply font-mono text-sm;
  }
  .backlink-card {
    @apply block rounded border-l-2 px-4 py-3;
    background: rgb(var(--color-card));
    border-color: rgb(var(--color-border-muted));
    text-decoration: none;
    transition: border-color var(--transition-base), background var(--transition-base);
  }
  .backlink-card:hover {
    border-color: rgb(var(--color-accent));
    background: rgb(var(--color-card-muted));
    text-decoration: none;
  }
  .backlink-header {
    @apply flex items-baseline gap-2;
  }
  .backlink-arrow {
    @apply text-xs;
    color: rgb(var(--color-border-muted));
    transition: color var(--transition-base);
  }
  .backlink-card:hover .backlink-arrow {
    color: rgb(var(--color-accent));
  }
  .backlink-title {
    @apply font-medium;
    color: rgb(var(--color-text-base));
    transition: color var(--transition-base);
  }
  .backlink-card:hover .backlink-title {
    color: rgb(var(--color-accent));
  }
  .backlink-type {
    @apply ml-auto text-xs uppercase;
    color: rgb(var(--color-base));
  }
  .backlink-desc {
    @apply mt-1.5 text-xs leading-relaxed;
    color: rgb(var(--color-base));
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
